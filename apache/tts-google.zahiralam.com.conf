<VirtualHost *:80>
  ServerName tts-google.zahiralam.com
  RewriteEngine On
  RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
  ServerName tts-google.zahiralam.com
  DocumentRoot /var/www/html/tts-google

  ErrorLog ${APACHE_LOG_DIR}/tts-google-error.log
  CustomLog ${APACHE_LOG_DIR}/tts-google-access.log combined

  <Directory /var/www/html/tts-google>
    Options -Indexes +FollowSymLinks
    AllowOverride None
    Require all granted

    RewriteEngine On

    # Never rewrite static assets (adjust if your Vite build output differs)
    RewriteRule ^assets/ - [L]
    RewriteRule ^vite\.svg$ - [L]

    # Never rewrite API
    RewriteRule ^api/ - [L]

    # Serve real files/dirs as-is
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # SPA fallback
    RewriteRule ^ index.html [L]
  </Directory>

  ProxyPreserveHost On
  RequestHeader set X-Forwarded-Proto "https"

  ProxyPass        /api http://127.0.0.1:7069/api
  ProxyPassReverse /api http://127.0.0.1:7069/api

  SSLCertificateFile /etc/letsencrypt/live/tts-google.zahiralam.com/fullchain.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/tts-google.zahiralam.com/privkey.pem
  Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
